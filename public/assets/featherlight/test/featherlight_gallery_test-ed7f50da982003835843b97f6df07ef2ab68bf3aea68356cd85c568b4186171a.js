var expect=chai.expect;!function(c){var t=null,e=function(){t||(t=c("#fixtures").detach()),c("body >:not(#mocha)").remove(),c("body").append(t.clone(!0))},a=function(t){c(window).trigger(c.Event("keyup",{keyCode:t}))};c.fx.off=!0,c.fn.toJSON=function(){return"jQuery: "+this.selector+" ("+this.length+")"},describe("Featherlight Gallery",function(){beforeEach(e),after(e),it("works as expected",function(t){c("#basic-test a").featherlightGallery(),c("#basic-test a").eq(2).click(),patiently(t,[function(){expect(c(".featherlight img")).to.have.attr("src").match(/photo_large.jpg\?2/),c(".featherlight").trigger("next")},function(){expect(c(".featherlight img")).to.have.attr("src").match(/photo_large.jpg\?3/),c(".featherlight-next").click()},function(){expect(c(".featherlight img")).to.have.attr("src").match(/photo_large.jpg\?0/),c(".featherlight").trigger("previous")},function(){expect(c(".featherlight img")).to.have.attr("src").match(/photo_large.jpg\?3/)}])}),it("can be navigated using arrow keys",function(t){c("#basic-test a").featherlightGallery(),c("#basic-test a").eq(2).click(),patiently(t,[function(){expect(c(".featherlight img")).to.have.attr("src").match(/photo_large.jpg\?2/),a(39)},function(){expect(c(".featherlight img")).to.have.attr("src").match(/photo_large.jpg\?3/),a(39)},function(){expect(c(".featherlight img")).to.have.attr("src").match(/photo_large.jpg\?0/),a(37)},function(){expect(c(".featherlight img")).to.have.attr("src").match(/photo_large.jpg\?3/)}])}),it("will keep modified background intact",function(t){c("#basic-test a").featherlightGallery({afterOpen:function(){this.$instance.find(".featherlight-content").append('<div class="something"/>')}}),c("#basic-test a").eq(2).click(),patiently(t,[function(){expect(c(".featherlight img")).to.have.attr("src").match(/photo_large.jpg\?2/),expect(c(".featherlight-content *:last-child")).to.have["class"]("something"),c(".featherlight").trigger("next")},function(){expect(c(".featherlight img")).to.have.attr("src").match(/photo_large.jpg\?3/),expect(c(".featherlight-content *:last-child")).to.have["class"]("something")}])}),it("can be setup without JS",function(t){c("#full-auto a:last").click(),patiently(t,[function(){expect(c(".featherlight img")).to.have.attr("src").match(/photo_large.jpg\?auto_1/),c(".featherlight").trigger("next")},function(){expect(c(".featherlight img")).to.have.attr("src").match(/photo_large.jpg\?auto_0/)}])}),it("is chainable",function(){var t=c("#basic-test a");expect(t.featherlight()).to.equal(t)}),it("triggers afterContent after each slide",function(t){var e=null;c("#basic-test a").featherlightGallery({afterContent:function(){e=this.$currentTarget}}),c("#basic-test a").eq(2).click(),patiently(t,[function(){expect(e).to.not.be["null"],expect(e).to.have.attr("href").match(/photo_large.jpg\?2/),c(".featherlight").trigger("next")},function(){expect(e).to.have.attr("href").match(/photo_large.jpg\?3/)}])}),describe("$.featherlightGallery",function(){it("can be called directly",function(t){var e=null,a='<img src="fixtures/photo.jpeg?direct_1"/><img src="fixtures/photo.jpeg?direct_2"/><img src="fixtures/photo.jpeg?direct_3"/>';c.featherlightGallery(c(a),{targetAttr:"src",afterContent:function(){e=this.$currentTarget}}),patiently(t,[function(){expect(c(".featherlight img")).to.have.attr("src").match(/direct_1$/),c(".featherlight").trigger("previous")},function(){expect(e).to.have.attr("src").match(/direct_3$/)}])})}),describe("$.featherlightGallery",function(){it("does not get confused with same images",function(t){var e='<img src="fixtures/photo.jpeg"/><img src="fixtures/photo.jpeg"/><img src="fixtures/photo.jpeg?direct_3"/>';c.featherlightGallery(c(e),{targetAttr:"src"}),c.fx.off=!1,patiently(t,[function(){expect(c(".featherlight img")).to.have.attr("src").match(/photo.jpeg$/),c(".featherlight").trigger("next")},function(){expect(c(".featherlight img")).to.have.css("opacity").lessThan(1)},function(){expect(c(".featherlight img")).to.have.css("opacity").equal("1"),c(".featherlight").trigger("next")},function(){expect(c(".featherlight img")).to.have.attr("src").match(/direct_3$/),c.fx.off=!0}])})}),it("accepts config as data-attributes",function(t){var e;c("#extra-test").featherlightGallery(),c("#extra-test a:first").click(),patiently(t,[function(){e=c.featherlightGallery.current(),expect(e).to.be.an["instanceof"](c.featherlightGallery),expect(e).to.have.property("called",!0),c(".featherlight").trigger("next")},function(){expect(c(".featherlight")).to.contain("Hello"),expect(c(".featherlight img")).to.not.be.visible}])}),it("can specify callbacks to track the progress of the dialog",function(t){var a=["beforeOpen","beforeContent","afterContent","afterOpen","beforeClose","afterClose"],i=undefined,r={targetAttr:"src"};c.each(a,function(t,e){r[e]=function(){expect(i).to.equal(a[t-1]),i=e}}),c.featherlightGallery(c('<img src="fixtures/photo.jpeg?direct_1"/>'),r),patiently(t,[function(){expect(i).to.equal("afterOpen"),c.featherlight.current().close()},function(){expect(i).to.equal("afterClose")}])}),it("sets last-slide and first-slide classes",function(t){c("#basic-test a").featherlightGallery(),c("#basic-test a").eq(3).click(),patiently(t,[function(){expect(c(".featherlight")).to.not.have["class"]("featherlight-first-slide"),expect(c(".featherlight")).to.have["class"]("featherlight-last-slide"),c(".featherlight").trigger("next")},function(){expect(c(".featherlight")).to.have["class"]("featherlight-first-slide"),expect(c(".featherlight")).to.not.have["class"]("featherlight-last-slide"),c(".featherlight-next").click()},function(){expect(c(".featherlight")).to.not.have["class"]("featherlight-first-slide"),expect(c(".featherlight")).to.not.have["class"]("featherlight-last-slide"),c(".featherlight").trigger("previous")},function(){expect(c(".featherlight")).to.have["class"]("featherlight-first-slide"),expect(c(".featherlight")).to.not.have["class"]("featherlight-last-slide")}])}),it("supports 'close:anywhere'",function(t){c("#basic-test").featherlightGallery({filter:"a",closeOnClick:"anywhere"});c("#basic-test a").eq(2).click(),patiently(t,[function(){expect(c(".featherlight img")).to.have.attr("src").match(/photo_large.jpg\?2/),c(".featherlight-next").click()},function(){expect(c(".featherlight img")).to.have.attr("src").match(/photo_large.jpg\?3/)}])}),describe(".current",function(){it("only returns actual featherlight gallery instances",function(){c.featherlight("<p>This is a test<p>"),expect(c.featherlight.current()).to.not.be["null"],expect(c.featherlightGallery.current()).to.be["null"]})})})}(jQuery);