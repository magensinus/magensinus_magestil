define(["../core","../var/isFunction","./var/nonce","./var/rquery","../ajax"],function(p,c,a,l){"use strict";var i=[],u=/(=)\?(?=&|$)|\?\?/;p.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var n=i.pop()||p.expando+"_"+a++;return this[n]=!0,n}}),p.ajaxPrefilter("json jsonp",function(n,a,o){var e,r,t,s=!1!==n.jsonp&&(u.test(n.url)?"url":"string"==typeof n.data&&0===(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&u.test(n.data)&&"data");if(s||"jsonp"===n.dataTypes[0])return e=n.jsonpCallback=c(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,s?n[s]=n[s].replace(u,"$1"+e):!1!==n.jsonp&&(n.url+=(l.test(n.url)?"&":"?")+n.jsonp+"="+e),n.converters["script json"]=function(){return t||p.error(e+" was not called"),t[0]},n.dataTypes[0]="json",r=window[e],window[e]=function(){t=arguments},o.always(function(){r===undefined?p(window).removeProp(e):window[e]=r,n[e]&&(n.jsonpCallback=a.jsonpCallback,i.push(e)),t&&c(r)&&r(t[0]),t=r=undefined}),"script"})});